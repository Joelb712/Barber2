{% load static %}
<table id="listametodos" class="min-w-full divide-y divide-gray-200">
    <thead class="bg-slate-700">
        <tr>
            <th class="px-4 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Nombre</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Estado</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-white uppercase tracking-wider">Acciones</th>
        </tr>
    </thead>
    <tbody class="bg-gray-300 divide-y divide-gray-200">
        {% for m in metodos %}
        <tr data-pk="{{ m.pk }}" class="{% if not m.activo %}inactivo{% endif %} hover:bg-amber-100">
            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-black">{{ m.nombre }}</td>
            <td class="px-4 py-3 whitespace-nowrap">
                <span class="px-2 inline-flex text-sm leading-5 font-semibold rounded-full 
                {% if m.activo %}bg-green-100 text-green-800{% else %}bg-red-100 text-red-800{% endif %}">
                {{ m.activo|yesno:"Activo,Inactivo" }}
                </span>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-m font-medium">
                {% if m.activo %}
                    <button class="btnDesactivar w-28 bg-red-500 text-black py-1 px-3 rounded" data-metodo-id="{{ m.pk }}">
                        Desactivar
                    </button>
                {% else %}
                    <button class="btnActivar w-28 bg-green-600 text-black py-1 px-3 rounded" data-metodo-id="{{ m.pk }}">
                        Activar
                    </button>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    // ðŸ’¡ INICIALIZACIÃ“N GARANTIZADA DE DATATABLES ðŸ’¡
    $(function() {
        
        // 1. Destruir DataTables anterior si existe (CLAVE para AJAX)
        if ($.fn.DataTable.isDataTable('#listametodos')) {
            $('#listametodos').DataTable().destroy();
        }

        // 2. Inicializar la tabla de MÃ‰TODOS DE PAGO
        $('#listametodos').DataTable({
            paging: true,
            searching: true,
            ordering: true,
            
            // OrdenaciÃ³n por defecto: Columna 0 (Nombre) ascendente
            order: [[1, 'desc']], 
            
            // Opciones de paginaciÃ³n
            lengthMenu: [
                [10, 20, 50, -1],
                [10, 20, 50, "Todos"]
            ],
            
            // Idioma en espaÃ±ol
            language: {
                url: "//cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json"
            },
            responsive: true,
            
        });
    });
</script>